import os
import pandas as pd

# ============================================================
# 1Ô∏è‚É£ Ï†ÄÏû• Í≤ΩÎ°ú ÏÑ§Ï†ï
# ============================================================
output_dir = "./data/cov_matrices"
os.makedirs(output_dir, exist_ok=True)


# ============================================================
# 2Ô∏è‚É£ Í≥µÎ∂ÑÏÇ∞ ÌñâÎ†¨ Ï†ïÏùò
# ============================================================
cov_dfs = {
    # ---------------------------
    # üîπ 8412: 1, 3, 4 Í≥µÏ†ï
    # ---------------------------
    "df_cov8412_1": [
        ["molten_temp", 108.027808, -172.394453],
        ["molten_volume", -172.394453, 634.633744],
    ],
    "df_cov8412_3": [
        ["low_section_speed", 127.876960, 134.655342, 22.687752, -8.754930, -53.034360],
        ["high_section_speed", 134.655342, 150.045114, 25.964681, -11.089454, -57.921923],
        ["cast_pressure", 22.687752, 25.964681, 73.645743, -7.729699, -41.922842],
        ["biscuit_thickness", -8.754930, -11.089454, -7.729699, 11.045913, 14.949799],
        ["physical_strength", -53.034360, -57.921923, -41.922842, 14.949799, 195.273963],
    ],
    "df_cov8412_4": [
        ["upper_mold_temp1", 1591.384130, 171.737395, -68.344648, 694.267212, 10.983294],
        ["upper_mold_temp2", 171.737395, 313.833970, 122.461660, 194.277955, 12.568786],
        ["lower_mold_temp1", -68.344648, 122.461660, 1056.410256, -76.971875, 5.942511],
        ["lower_mold_temp2", 694.267212, 194.277955, -76.971875, 1124.600061, 20.073014],
        ["Coolant_temperature", 10.983294, 12.568786, 5.942511, 20.073014, 4.745007],
    ],

    # ---------------------------
    # üîπ 8413
    # ---------------------------
    "df_cov8413_1": [
        ["molten_temp", 2.181921, 5.210734],
        ["molten_volume", 5.210734, 231.542090],
    ],
    "df_cov8413_3": [
        ["low_section_speed", 0, 0, 0, 0, 0],
        ["high_section_speed", 0, 0.281356, -0.001695, -0.166102, 0.059322],
        ["cast_pressure", 0, -0.001695, 0.048305, -0.003390, 0.072034],
        ["biscuit_thickness", 0, -0.166102, -0.003390, 6.820339, -1.881356],
        ["physical_strength", 0, 0.059322, 0.072034, -1.881356, 6.586158],
    ],
    "df_cov8413_4": [
        ["upper_mold_temp1", 11.616949, 21.393220, 37.664407, 26.400000, 3.489831],
        ["upper_mold_temp2", 21.393220, 56.298305, 85.518644, 54.657627, 8.037288],
        ["lower_mold_temp1", 37.664407, 85.518644, 142.541243, 96.341243, 13.339548],
        ["lower_mold_temp2", 26.400000, 54.657627, 96.341243, 69.097175, 8.990395],
        ["Coolant_temperature", 3.489831, 8.037288, 13.339548, 8.990395, 1.406497],
    ],

    # ---------------------------
    # üîπ 8576
    # ---------------------------
    "df_cov8576_1": [
        ["molten_temp", 2.519156, 0],
        ["molten_volume", 0, 0],
    ],
    "df_cov8576_3": [
        ["low_section_speed", 0.097403, -0.022078, -0.016883, 0.161688, 0.311039],
        ["high_section_speed", -0.022078, 0.362338, 0.042857, -0.082468, 0.246104],
        ["cast_pressure", -0.016883, 0.042857, 0.222078, -0.060390, 1.060390],
        ["biscuit_thickness", 0.161688, -0.082468, -0.060390, 3.872403, 0.145779],
        ["physical_strength", 0.311039, 0.246104, 1.060390, 0.145779, 120.054221],
    ],
    "df_cov8576_4": [
        ["upper_mold_temp1", 894.244156, 94.612987, 108.516883, 15.051948, -6.353247],
        ["upper_mold_temp2", 94.612987, 68.970130, 97.344805, 89.366883, 6.246104],
        ["lower_mold_temp1", 108.516883, 97.344805, 154.119156, 142.822403, 10.485390],
        ["lower_mold_temp2", 15.051948, 89.366883, 142.822403, 177.160714, 12.100325],
        ["Coolant_temperature", -6.353247, 6.246104, 10.485390, 12.100325, 1.137338],
    ],

    # ---------------------------
    # üîπ 8722
    # ---------------------------
    "df_cov8722_1": [
        ["molten_temp", 223.366186, -83.535979],
        ["molten_volume", -83.535979, 685.859302],
    ],
    "df_cov8722_3": [
        ["low_section_speed", 25.368105, 13.603162, 6.913507, 0.884923, 18.318729],
        ["high_section_speed", 13.603162, 58.279450, 1.330811, -3.100607, 6.466901],
        ["cast_pressure", 6.913507, 1.330811, 15.496278, -3.820112, 44.425305],
        ["biscuit_thickness", 0.884923, -3.100607, -3.820112, 14.772464, -15.712934],
        ["physical_strength", 18.318729, 6.466901, 44.425305, -15.712934, 303.934901],
    ],
    "df_cov8722_4": [
        ["upper_mold_temp1", 958.654604, 347.361164, 348.391187, -78.622508, -15.440608],
        ["upper_mold_temp2", 347.361164, 733.723937, -45.736142, -210.819360, -33.941177],
        ["lower_mold_temp1", 348.391187, -45.736142, 1944.734352, -962.277183, 44.056452],
        ["lower_mold_temp2", -78.622508, -210.819360, -962.277183, 1825.466947, -1.335291],
        ["Coolant_temperature", -15.440608, -33.941177, 44.056452, -1.335291, 8.105254],
    ],

    # ---------------------------
    # üîπ 8917
    # ---------------------------
    "df_cov8917_1": [
        ["molten_temp", 119.587302, 100.379136],
        ["molten_volume", 100.379136, 1304.503413],
    ],
    "df_cov8917_3": [
        ["low_section_speed", 10.208602, 5.215599, 1.226577, -0.387230, 0.525340],
        ["high_section_speed", 5.215599, 10.401384, 0.556699, -1.010207, -1.981685],
        ["cast_pressure", 1.226577, 0.556699, 3.658302, 0.979020, 1.160507],
        ["biscuit_thickness", -0.387230, -1.010207, 0.979020, 14.234561, 7.710724],
        ["physical_strength", 0.525340, -1.981685, 1.160507, 7.710724, 59.029980],
    ],
    "df_cov8917_4": [
        ["upper_mold_temp1", 2184.691133, 59.490486, 215.500601, 969.129771, -24.260635],
        ["upper_mold_temp2", 59.490486, 229.163234, 322.152171, 173.589358, 0.917755],
        ["lower_mold_temp1", 215.500601, 322.152171, 1163.697249, -425.509129, -5.583567],
        ["lower_mold_temp2", 969.129771, 173.589358, -425.509129, 1900.700261, -16.166537],
        ["Coolant_temperature", -24.260635, 0.917755, -5.583567, -16.166537, 4.328931],
    ],
}


# ============================================================
# 3Ô∏è‚É£ ÌååÏùº ÏÉùÏÑ±
# ============================================================
for name, data in cov_dfs.items():
    # Ï≤´ Î≤àÏß∏ Ïª¨ÎüºÎ™ÖÏùÑ Í∏∞Ï§ÄÏúºÎ°ú ÎÇòÎ®∏ÏßÄ Ïó¥ Ïù¥Î¶Ñ ÏßÄÏ†ï
    col_names = ["var"] + [row[0] for row in data]
    df = pd.DataFrame(data, columns=col_names)
    path = os.path.join(output_dir, f"{name}.csv")
    df.to_csv(path, index=False)
    print(f"‚úÖ {path} Ï†ÄÏû• ÏôÑÎ£å")

print("üéâ Î™®Îì† Í≥µÎ∂ÑÏÇ∞ ÌñâÎ†¨ CSV ÌååÏùº ÏÉùÏÑ± ÏôÑÎ£å!")
